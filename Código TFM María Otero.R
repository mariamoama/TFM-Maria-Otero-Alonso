
#######
# TFM #
#######


###### GRUPOS DE VARIABLES #####

# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"

# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			

# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															

# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				

# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		

# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			

# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														


library(plyr)
library(dplyr)
library(caret)
library(randomForest)
library(sas7bdat)
library(dummies)

source ("E://TFM//cruzadas avnnet y log binaria.R")
source ("E://TFM//cruzada arbolbin.R")
source ("E://TFM//cruzada rf binaria.R")
source ("E://TFM//cruzada xgboost binaria.R")
source ("E://TFM//cruzada gbm binaria.R")
source ("E://TFM//cruzada SVM binaria lineal.R")
source ("E://TFM//cruzada SVM binaria polinomial.R")
source ("E://TFM//cruzada SVM binaria RBF.R")

#datos<-read.sas7bdat("C://Users//usuario//Desktop//TFM//DATOS_SAS//ABC_TRANSFORMADOS_TRAIN.sas7bdat")
datos<-read.sas7bdat("E://TFM//Datos finales//ABC_TRANSFORMADOS_TRAIN.sas7bdat")

dput(names(datos))
summary(datos)

continuas<-c( "aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"be",	"bo",	"bs",	"bv",	"c",	"cd",	"ci",	"cp",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z")
categoricas<-c("ao",	"ar",	"as",	"at",	"au",	"av",	"aw",	"bf",	"bg",	"bh",	"bi",	"bj",	"bk",	"bl",	"bm",	"bn",	"bp",	"bq",	"br",	"bt",	"bu",	"bw",	"bx",	"by",	"bz",	"ca",	"cb",	"cc",	"ce",	"cf",	"cg",	"ch",	"cj",	"ck",	"cl",	"cm",	"cn",	"co",	"cq",	"cr",	"cs",	"ct",	"e",	"f",	"g")


#Cambio la variable dependiente 'b', de valores N y Y a 'b1', de valores No y Yes
datos$b <- recode(datos$b, '0' = "No" , '1' = "Yes")
table(datos$b)

#Cambio la variable bm
datos$bm <- recode(datos$bm, '01:low-0.0032468, MISSING' = "1" , '02:0.0032468-high' = "2")
table(datos$bm)


################################
# ESTANDARIZAR DATOS Y GUARDAR # 
################################


# OBJETIVO: "b"

# a) Eliminar las observaciones con missing en alguna variable

datossinmissings<-na.omit(datos,(!is.na(datos)))

# b) Pasar las categoricas a dummies

datosdummy<- dummy.data.frame(datossinmissings, categoricas, sep = ".")

# c) Estandarizar las variables continuas

# Calculo medias y dtipica de datos y estandarizo (solo las continuas)

means <- apply(datosdummy[,continuas],2,mean) 
sds<- sapply(datosdummy[,continuas],sd) 


# Estandarizo solo las continuas y uno con las categoricas

datoscompletos<-scale(datosdummy[,continuas], center = means, scale = sds)
numerocont<-which(colnames(datosdummy)%in%continuas)
datoscompletos<-cbind(datoscompletos,datosdummy[,-numerocont])


# El archivo saheartbis ya estÃ¡ preparado:no hay missing, las continuas salvo la dependiente 
# estÃ¡n estandarizadas y las categoricas pasadas a dummy

dput(names(datoscompletos))

# Guardar

save(datoscompletos,file='DatoscompletosNUEVOS.RData')
write.csv2(datoscompletos, "datoscompletosNUEVOS.csv") 

# ******************************************
# MUESTREO ALEATORIO ESTRATIFICADO
# ******************************************

# Muestreo aleatorio estratificado por la variable dependiente

table(datos$b)
prop.table(table(datos$b)) # 81,33% de 0 y un 18,67% de 1

# Al estratificar mantenemos esos % en la muestra obtenida

# Tomamos sample_frac(0.10) (1/4 de los 462 para tener aproximadamente 100 observaciones finales)

datoscompletos1 <- datoscompletos %>%
  group_by(b) %>%
  sample_frac(0.10)

table(datoscompletos1$b)
prop.table(table(datoscompletos1$b))


# No - 81,33 %
# Yes - 18,67 %

getwd()
save(datoscompletos1,file='DatosmuestaNUEVOS.RData')
write.csv2(datoscompletos1, "datosmuestaNUEVOS.csv") 

#############
# LOGISTICA # 
#############

#Variables del primer grupo 
medias1<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias1$modelo="Logistica1"

#Variables del segundo grupo
medias2<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias2$modelo="Logistica2"

#Variables del tercer grupo 
medias3<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias3$modelo="Logistica3"

#Variables del cuarto grupo 
medias4<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias4$modelo="Logistica4"

#Variables del quinto grupo 
medias5<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias5$modelo="Logistica5"

#Variables del sexto grupo 
medias6<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias6$modelo="Logistica6"

#Variables del septimo grupo 
medias7<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias7$modelo="Logistica7"

#Variables del octavo grupo 
medias8<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=10)

medias8$modelo="Logistica8"

# Comparamos los modelos

union<-rbind(medias1,medias2,medias3,medias4,medias5,medias6,medias7,medias8)

par(cex.axis=0.5)
boxplot(data=union,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union,auc~modelo,main="AUC",col="pink")

# Comparamos los mejores modelos (medias 1,medias 4 y medias 8)

union2<-rbind(medias1,medias4,medias8)

par(cex.axis=0.5)
boxplot(data=union2,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union2,auc~modelo,main="AUC",col="pink")


#########
# ARBOL # 
#########

#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

medias9<-cruzadaarbolbin(data=datoscompletos,
                          vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                          listclass=c(""),grupos=4,sinicio=1234,repe=10,
                          cp=c(0),minbucket =5)

medias9$modelo="arbol1"

#Variables del segundo grupo 
# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"

medias10<-cruzadaarbolbin(data=datoscompletos,
                         vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),grupos=4,sinicio=1234,repe=10,
                         cp=c(0),minbucket =5)

medias10$modelo="arbol2"

#Variables del tercer grupo 
# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			

medias11<-cruzadaarbolbin(data=datoscompletos,
                         vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),grupos=4,sinicio=1234,repe=10,
                         cp=c(0),minbucket =5)

medias11$modelo="arbol13"

#Variables del cuarto grupo 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															

medias12<-cruzadaarbolbin(data=datoscompletos,
                         vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),grupos=4,sinicio=1234,repe=10,
                         cp=c(0),minbucket =5)

medias12$modelo="arbol14"

#Variables del quinto grupo 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				

medias13<-cruzadaarbolbin(data=datoscompletos,
                         vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),grupos=4,sinicio=1234,repe=10,
                         cp=c(0),minbucket =5)

medias13$modelo="arbol5"

#Variables del sexto grupo 
# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		

medias14<-cruzadaarbolbin(data=datoscompletos,
                         vardep="b",listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),grupos=4,sinicio=1234,repe=10,
                         cp=c(0),minbucket =5)

medias14$modelo="arbol6"

#Variables del septimo grupo 
# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			

medias15<-cruzadaarbolbin(data=datoscompletos,
                         vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),grupos=4,sinicio=1234,repe=10,
                         cp=c(0),minbucket =5)

medias15$modelo="arbol7"

#Variables del octavo grupo
# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														

medias16<-cruzadaarbolbin(data=datoscompletos,
                         vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                         listclass=c(""),grupos=4,sinicio=1234,repe=10,
                         cp=c(0),minbucket =5)

medias16$modelo="arbol8"

# Comparamos los modelos

union3<-rbind(medias9,medias10,medias11,medias12,medias13,medias14,medias15,medias16)

par(cex.axis=0.5)
boxplot(data=union3,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union3,auc~modelo,main="AUC",col="pink")



#############################
# REDES NEURONALES BINARIAS # 
#############################

library(sas7bdat)
library(nnet)
library(h2o)
library(MASS)
library(reshape)
library(caret)


# TUNING CON CARET

set.seed(12346)

# Validacion cruzada repetida para hacer el tuneado 
control<-trainControl(method = "repeatedcv",number=4,repeats=5,
                      savePredictions = "all",classProbs=TRUE) 

#Variables del primer grupo 
# aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

avnnetgrid <-expand.grid(size=c(1,2,3,4),decay=c(0.01,0.1,0.2,0.001),bag=FALSE)

redavnnet1<- train(b~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet1


#Variables del segundo grupo
# ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1
redavnnet2<- train(b~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet2


#Variables del tercer grupo 
# al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1
redavnnet3<- train(b~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet3


#Variables del cuarto grupo 
# ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

avnnetgrid <-expand.grid(size=c(1,2,3,4,5,6),decay=c(0.01,0.1,0.2,0.001),bag=FALSE)

redavnnet4<- train(b~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet4

#Variables del quinto grupo 
# ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1

avnnetgrid <-expand.grid(size=c(1,2,3,4,5),decay=c(0.01,0.1,0.2,0.001),bag=FALSE)

redavnnet5<- train(b~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet5

#Variables del sexto grupo 
# ac+ag+ai+an+d+s+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1
redavnnet6<- train(b~ac+ag+ai+an+d+s+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet6

#Variables del septimo grupo 
# ac+ai+an+d+s+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1
redavnnet7<- train(b~ac+ai+an+d+s+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet7

#Variables del octavo grupo
# aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3

avnnetgrid <-expand.grid(size=c(1,2,3,4,5,7,9),decay=c(0.01,0.1,0.2,0.001),bag=FALSE)

redavnnet8<- train(b~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,
                  data=datoscompletos1,
                  method="avNNet",linout = FALSE,maxit=50,trControl=control,tuneGrid=avnnetgrid,
                  repeats=5)

redavnnet8

##### COMPARACION MEJORES MODELOS ######

#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

medias17<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(4),decay=c(0.2),repeticiones=5,itera=50)

medias17$modelo="REDES1"

#Variables del segundo grupo 
# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"
medias18<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(3),decay=c(0.1),repeticiones=5,itera=50)

medias18$modelo="REDES2"

#Variables del tercer grupo 
# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			
medias19<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(4),decay=c(0.2),repeticiones=5,itera=50)

medias19$modelo="REDES3"

#Variables del cuarto grupo 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															
medias20<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(4),decay=c(0.2),repeticiones=5,itera=50)

medias20$modelo="REDES4"

#Variables del quinto grupo 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				
medias21<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(4),decay=c(0.1),repeticiones=5,itera=50)

medias21$modelo="REDES5"

#Variables del sexto grupo 
# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		
medias22<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(4),decay=c(0.1),repeticiones=5,itera=50)

medias22$modelo="REDES6"

#Variables del septimo grupo 
# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			
medias23<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(4),decay=c(0.1),repeticiones=5,itera=50)

medias23$modelo="REDES7"

#Variables del octavo grupo
# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														
medias24<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=10,
                           size=c(4),decay=c(0.2),repeticiones=5,itera=50)

medias24$modelo="REDES8"

# Comparar modelos
union4<-rbind(medias17,medias18,medias19,medias20,medias21,medias22,medias23,medias24)

par(cex.axis=0.5)
boxplot(data=union4,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union4,auc~modelo,main="AUC",col="pink")


# MEJOR MODELO REDES: REDES3



###########
# BAGGING # 
###########

library(caret)
library(randomForest)
library(sas7bdat)
library(dummies)


#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														
# GRUPO 1 = aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

### Primera aproximación bruta
set.seed(12345)
rfgrid<-expand.grid(mtry=c(66)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf<- train(factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(2000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                      data=datoscompletos1,
                      mtry=20,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del segundo grupo 
# ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1
set.seed(12345)
rfgrid<-expand.grid(mtry=c(80)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf<- train(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(2000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                      data=datoscompletos1,
                      mtry=80,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.165,0.175))
  
}

par("mar")
par(mar=c(5.1,4.1,4.1,2.1))
plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))

#Variables del tercer grupo 
# al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1

set.seed(12345)
rfgrid<-expand.grid(mtry=c(77)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf<- train(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(2000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                      data=datoscompletos1,
                      mtry=77,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del cuarto grupo 
# ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0
set.seed(12345)
rfgrid<-expand.grid(mtry=c(49)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf<- train(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(2000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
                      data=datoscompletos1,
                      mtry=49,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del quinto grupo. Estudio valido para grupo 6 y 7 
# ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1
set.seed(12345)
rfgrid<-expand.grid(mtry=c(60)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf<- train(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(2000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
                      data=datoscompletos1,
                      mtry=60,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del octavo grupo
# aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3
set.seed(12345)
rfgrid<-expand.grid(mtry=c(34)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf<- train(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(2000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,
                      data=datoscompletos1,
                      mtry=34,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


# Se comprueban modelos mediante validacion cruzada repetida

#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

datoscompletos2 <- factor(as.character(datoscompletos))

# Con reemplazamiento y nodesize 20
medias25<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=65,ntree=450,sampsize=2500,replace=TRUE) #sampsize=2500

medias25$modelo="BAG1.1"
union1<-rbind(medias25)

# Sin reemplazamiento y nodesize 20
medias26<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=66,ntree=450,sampsize=2500,replace=FALSE) #sampsize=2500

medias26$modelo="BAG1.2"

#Variables del segundo grupo 
# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"
medias27<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=80,ntree=75,sampsize=2500,replace=TRUE) #sampsize=2500

medias27$modelo="BAG2.1"

# Sin reemplazamiento y nodesize 20

medias28<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=80,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias28$modelo="BAG2.2"


#Variables del tercer grupo 
# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			
medias29<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=77,ntree=450,sampsize=2500,replace=TRUE) #sampsize=2500

medias29$modelo="BAG3.1"

# Sin reemplazamiento y nodesize 20
medias30<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=77,ntree=450,sampsize=2500,replace=FALSE) #sampsize=2500

medias30$modelo="BAG3.2"

#Variables del cuarto grupo 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															
medias31<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=49,ntree=250,sampsize=2500,replace=TRUE) #sampsize=2500

medias31$modelo="BAG4.1"

# Sin reemplazamiento y nodesize 20
medias32<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=49,ntree=250,sampsize=2500,replace=FALSE) #sampsize=2500

medias32$modelo="BAG4.2"


#Variables del quinto grupo 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				
medias33<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=60,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias33$modelo="BAG5.1"

# Sin reemplazamiento y nodesize 20
medias34<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=60,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias34$modelo="BAG5.2"

#Variables del sexto grupo 
# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		
medias35<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=60,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias35$modelo="BAG6.1"

# Sin reemplazamiento y nodesize 20
medias36<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=60,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias36$modelo="BAG6.2"

#Variables del septimo grupo 
# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			
medias37<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=60,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias37$modelo="BAG7.1"

# Sin reemplazamiento y nodesize 20
medias38<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=10,nodesize=20,
                       mtry=60,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias38$modelo="BAG7.2"

#Variables del octavo grupo
# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														
medias39<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=34,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias39$modelo="BAG8.1"

# Sin reemplazamiento y nodesize 20
medias40<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=34,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias40$modelo="BAG8.2"


#COMPARAMOS MEJOR MODELO BAGGING

union5<-rbind(medias25,	medias26,	medias27,	medias28,	medias29,	medias30,	medias31,	medias32,	medias33,	medias34,	medias35,	medias36,	medias37,	medias38,	medias39,	medias40)

par(cex.axis=0.5)
boxplot(data=union5,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union5,auc~modelo,main="AUC",col="pink")

# MEJOR MODELO BAGGING: BAG1.2


#################
# RAMDON FOREST # 
#################

library(caret)
library(randomForest)
library(sas7bdat)
library(dummies)


#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														
# GRUPO 1 = aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

### Primera aproximación bruta
set.seed(12345)
rfgrid<-expand.grid(mtry=c(3,	4,	5,	6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33,	34,	35,	36,	37,	38,	39,	40,	41,	42,	43,	44,	45,	46,	47,	48,	49,	50,	51,	52,	53,	54,	55,	56,	57,	58,	59,	60,	61,	62,	63,	64))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                     classProbs=TRUE) 

rf<- train(factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(3000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
   #controlamos la semilla pues bagging depende de ella
    set.seed(12345) 
    rfbis<-randomForest(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                       data=datoscompletos1,
                        mtry=19,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
    plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
  }


#Variables del segundo grupo 
# ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1
set.seed(12345)
rfgrid<-expand.grid(mtry=c(1,2,3,4,5,6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33,	34,	35,	36,	37,	38,	39,	40,	41,	42,	43,	44,	45,	46,	47,	48,	49,	50,	51,	52,	53,	54,	55,	56,	57,	58,	59,	60,	61,	62,	63,	64,	65,	66,	67,	68,	69,	70,	71,	72,	73,	74,	75,	76,	77,	78,	79)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf2<- train(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf2 # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)



# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(3000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                      data=datoscompletos1,
                      mtry=11,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del tercer grupo 
# al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1
# 77

set.seed(12345)
rfgrid<-expand.grid(mtry=c(1,2,3,4,5,6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33,	34,	35,	36,	37,	38,	39,	40,	41,	42,	43,	44,	45,	46,	47,	48,	49,	50,	51,	52,	53,	54,	55,	56,	57,	58,	59,	60,	61,	62,	63,	64,	65,	66,	67,	68,	69,	70,	71,	72,	73,	74,	75,	76)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf3<- train(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf3 # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(3000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
                      data=datoscompletos1,
                      mtry=11,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del cuarto grupo 
# ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0
# 49

set.seed(12345)
rfgrid<-expand.grid(mtry=c(1,2,3,4,5,6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33,	34,	35,	36,	37,	38,	39,	40,	41,	42,	43,	44,	45,	46,	47,	48)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf4<- train(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf4 # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(3000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
                      data=datoscompletos1,
                      mtry=8,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del quinto grupo. Estudio valido para grupo 6 y 7 
# ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1
# 60

set.seed(12345)
rfgrid<-expand.grid(mtry=c(1,2,3,4,5,6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33,	34,	35,	36,	37,	38,	39,	40,	41,	42,	43,	44,	45,	46,	47,	48,	49,	50,	51,	52,	53,	54,	55,	56,	57,	58,	59)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf5<- train(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf5 # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(3000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
                      data=datoscompletos1,
                      mtry=9,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


#Variables del octavo grupo
# aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3
set.seed(12345)
rfgrid<-expand.grid(mtry=c(1,2,3,4,5,6,	7,	8,	9,	10,	11,	12,	13,	14,	15,	16,	17,	18,	19,	20,	21,	22,	23,	24,	25,	26,	27,	28,	29,	30,	31,	32,	33)) #Coge todas las variables

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

rf8<- train(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,data=datoscompletos1,
           method="rf",trControl=control,tuneGrid=rfgrid,
           linout = FALSE,ntree=300,nodesize=20,replace=TRUE,
           importance=TRUE) #utilizamos reemplazamiento en este caso y que considere la importancia de cada variable
rf8 # Coger el numero donde el accuracy es maximo mtry = 3 (para sortear x variables de las 14)


# Comprobamos los gráficos cambiando la semilla 
for (muestra in seq(3000,3000,100)) #desde 1000 a 2000 de 200 en 200
{
  # controlamos la semilla pues bagging depende de ella
  set.seed(12345) 
  rfbis<-randomForest(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,
                      data=datoscompletos1,
                      mtry=5,ntree=3000,sampsize=muestra,nodesize=20,replace=TRUE)
  
  plot(rfbis$err.rate[,1],main=muestra,ylim=c(0.144,0.160))
  
}


# Se comprueban modelos mediante validacion cruzada repetida

#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

medias55<-cruzadarfbin(data=datoscompletos,
                      vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                      listclass=c(""),
                      grupos=4,sinicio=1234,repe=5,nodesize=20,
                      mtry=19,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias55$modelo="rf1.1"

#Probamos ahora sin reemplazamiento
medias56<-cruzadarfbin(data=datoscompletos,
                      vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                      listclass=c(""),
                      grupos=4,sinicio=1234,repe=5,nodesize=20,
                      mtry=19,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias56$modelo="rf1.2"

#Variables del segundo grupo 
# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"

medias41<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=11,ntree=150,sampsize=2500,replace=TRUE) #sampsize=2500

medias41$modelo="rf2.1"

#Probamos ahora sin reemplazamiento
medias42<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=11,ntree=150,sampsize=2500,replace=FALSE) #sampsize=2500

medias42$modelo="rf2.2"

#Variables del tercer grupo 
# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			

medias43<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=11,ntree=175,sampsize=2500,replace=TRUE) #sampsize=2500

medias43$modelo="rf3.1"

#Probamos ahora sin reemplazamiento
medias44<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=11,ntree=175,sampsize=2500,replace=FALSE) #sampsize=2500

medias44$modelo="rf3.2"

#Variables del cuarto grupo 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															


medias45<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=8,ntree=150,sampsize=2500,replace=TRUE) #sampsize=2500

medias45$modelo="rf4.1"

#Probamos ahora sin reemplazamiento
medias46<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=8,ntree=150,sampsize=2500,replace=FALSE) #sampsize=2500

medias46$modelo="rf4.2"

#Variables del quinto grupo 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				

medias47<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=9,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias47$modelo="rf5.1"

#Probamos ahora sin reemplazamiento
medias48<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=9,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias48$modelo="rf5.2"

#Variables del sexto grupo 
# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		

medias49<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=9,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias49$modelo="rf6.1"

#Probamos ahora sin reemplazamiento
medias50<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=9,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias50$modelo="rf6.2"

#Variables del septimo grupo 
# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			

medias51<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=9,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias51$modelo="rf7.1"

#Probamos ahora sin reemplazamiento
medias52<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=9,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias52$modelo="rf7.2"

#Variables del octavo grupo
# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														

medias53<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=5,ntree=100,sampsize=2500,replace=TRUE) #sampsize=2500

medias53$modelo="rf8.1"

#Probamos ahora sin reemplazamiento
medias54<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=5,ntree=100,sampsize=2500,replace=FALSE) #sampsize=2500

medias54$modelo="rf8.2"

#COMPARAMOS MEJOR MODELO RF

union6<-rbind(medias55,medias56,medias41,medias42,medias43,medias44,medias45,medias46,medias47,medias48,medias49,medias50,medias51,medias52,medias53,medias54)

par(cex.axis=0.5)
boxplot(data=union6,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union6,auc~modelo,main="AUC",col="pink")


# MEJOR MODELO RF: RF4.1 



#############################
# GRADIENT BOOSTING MACHINE # 
#############################

# Caret permite tunear estos parametros basicos:
#  
# 	shrinkage (parÃ¡metro v de regularizaciÃ³n, mide la velocidad de ajuste, a menor v, mÃ¡s lento y necesita mÃ¡s iteraciones, pero es mÃ¡s fino en el ajuste)
# 	n.minobsinnode: tamaÃ±o mÃ¡ximo de nodos finales (el principal parÃ¡metro que mide la complejidad)
# 	n.trees=el nÃºmero de iteraciones (Ã¡rboles)
# 	interaction.depth (2 para Ã¡rboles binarios)
library(caret)


#Variables del primer grupo 
# aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

set.seed(12345)

gbmgrid<-expand.grid(shrinkage=c(0.1,0.05,0.01,0.001),
                     n.minobsinnode=c(15,25),
                     n.trees=c(100,500,1000,3000),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

gbm

plot(gbm)

# ESTUDIO DE EARLY STOPPING

gbmgrid<-expand.grid(shrinkage=c(0.05),
                     n.minobsinnode=c(15),
                     n.trees=c(100,300,500,650,800,1000),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

plot(gbm,ylim=c(0.84,0.86))


#Variables del segundo grupo 
# ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1

set.seed(12345)

gbmgrid<-expand.grid(shrinkage=c(0.1,0.05,0.01,0.001),
                     n.minobsinnode=c(15,25),
                     n.trees=c(100,500,1000,3000),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

gbm

plot(gbm)

# ESTUDIO DE EARLY STOPPING

gbmgrid<-expand.grid(shrinkage=c(0.01),
                     n.minobsinnode=c(25),
                     n.trees=c(600,700,800,900,1000,1100,1200),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

plot(gbm,ylim=c(0.84,0.86))



#Variables del tercer grupo 
# al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1

set.seed(12345)

gbmgrid<-expand.grid(shrinkage=c(0.1,0.05,0.01,0.001),
                     n.minobsinnode=c(15,25),
                     n.trees=c(100,500,1000,3000),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

gbm

plot(gbm)

# ESTUDIO DE EARLY STOPPING

gbmgrid<-expand.grid(shrinkage=c(0.05),
                     n.minobsinnode=c(15),
                     n.trees=c(300,400,500,600,700,800),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

plot(gbm,ylim=c(0.84,0.86))



#Variables del cuarto grupo 
# ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

set.seed(12345)

gbmgrid<-expand.grid(shrinkage=c(0.1,0.05,0.01,0.001),
                     n.minobsinnode=c(15,25),
                     n.trees=c(100,500,1000,3000),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

gbm

plot(gbm)

# ESTUDIO DE EARLY STOPPING

gbmgrid<-expand.grid(shrinkage=c(0.1),
                     n.minobsinnode=c(15),
                     n.trees=c(50,60,70,80,90,100,110,120,130),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

plot(gbm,ylim=c(0.84,0.86))



#Variables del quinto, sexto y septimo grupo 
# ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1

set.seed(12345)

gbmgrid<-expand.grid(shrinkage=c(0.1,0.05,0.01,0.001),
                     n.minobsinnode=c(15,25),
                     n.trees=c(100,500,1000,3000),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

gbm

plot(gbm)

# ESTUDIO DE EARLY STOPPING

gbmgrid<-expand.grid(shrinkage=c(0.1),
                     n.minobsinnode=c(15),
                     n.trees=c(50,60,70,80,90,100,110,120,130,140),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

plot(gbm,ylim=c(0.84,0.86))



#Variables del octavo grupo
# aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3

set.seed(12345)

gbmgrid<-expand.grid(shrinkage=c(0.1,0.05,0.01,0.001),
                     n.minobsinnode=c(15,25),
                     n.trees=c(100,500,1000,3000),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

gbm

plot(gbm)

# ESTUDIO DE EARLY STOPPING

gbmgrid<-expand.grid(shrinkage=c(0.05),
                     n.minobsinnode=c(25),
                     n.trees=c(200,300,400,500,600,700,800,900),
                     interaction.depth=c(2))

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

gbm<- train(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,data=datoscompletos1,
            method="gbm",trControl=control,tuneGrid=gbmgrid,
            distribution="bernoulli", bag.fraction=1,verbose=FALSE)

plot(gbm,ylim=c(0.84,0.86))


# Comparamos modelos con validación cruzada repetida

#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"
medias57<-cruzadagbmbin(data=datoscompletos, vardep="b",
                       listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,
                       n.minobsinnode=15,shrinkage=0.05,n.trees=500,interaction.depth=2)

medias57$modelo="gbm1"


#Variables del segundo grupo 
# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"
medias58<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=25,shrinkage=0.01,n.trees=900,interaction.depth=2)

medias58$modelo="gbm2"

#Variables del tercer grupo 
# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			
medias59<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=15,shrinkage=0.05,n.trees=500,interaction.depth=2)

medias59$modelo="gbm3"

#Variables del cuarto grupo 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															
medias60<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=15,shrinkage=0.1,n.trees=60,interaction.depth=2)

medias60$modelo="gbm4"

#Variables del quinto grupo 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				
medias61<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=15,shrinkage=0.1,n.trees=90,interaction.depth=2)

medias61$modelo="gbm5"

#Variables del sexto grupo 
# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		
medias62<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=15,shrinkage=0.1,n.trees=90,interaction.depth=2)

medias62$modelo="gbm6"

#Variables del septimo grupo 
# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			
medias63<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=15,shrinkage=0.1,n.trees=90,interaction.depth=2)

medias63$modelo="gbm7"

#Variables del octavo grupo
# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														
medias64<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=25,shrinkage=0.05,n.trees=700,interaction.depth=2)

medias64$modelo="gbm8"

# Comparamos los mejores modelos GBM
union7<-rbind(medias57,medias58,medias59,medias60,medias61,medias62,medias63,medias64)

par(cex.axis=0.5)
boxplot(data=union7,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union7,auc~modelo,main="AUC",col="pink")


# Mejor modelo GBM:


###########
#XGBMBOOST#
###########


# Caret permite tunear estos parÃ¡metros bÃ¡sicos:

# nrounds (# Boosting Iterations)
# max_depth (Max Tree Depth)
# eta (Shrinkage)
# gamma (Minimum Loss Reduction)
# colsample_bytree (Subsample Ratio of Columns)
# min_child_weight (Minimum Sum of Instance Weight)
# subsample (Subsample Percentage)



#Variables del primer grupo 
# aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

set.seed(12345)

xgbmgrid<-expand.grid(
  min_child_weight=c(5,10,20),
  eta=c(0.1,0.05,0.03,0.01,0.001),
  nrounds=c(100,500,1000,5000),
  max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

xgbm

plot(xgbm)

# IMPORTANCIA DE VARIABLES

varImp(xgbm)
plot(varImp(xgbm))

#·················· PRUEBO PARÃMETROS CON VARIABLES SELECCIONADAS

xgbmgrid<-expand.grid(
  min_child_weight=c(5,10,20),
  eta=c(0.1,0.05,0.03,0.01,0.001),
  nrounds=c(100,500,1000,5000,6000,7000),
  max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~fnlwgt+capital_loss+capital_gain+age+education_num+hours_per_week+marital.Divorced+marital.Married+relationship.Husband+relationship.Ownchild+native_country.Si+occupation.Execmanagerial+occupation.Machineopinspct+occupation.Otherservice+occupation.Profspecialty+workclass.Otro,data=datoscompletos,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

xgbm

plot(xgbm)
# ESTUDIO DE EARLY STOPPING
# Probamos a fijar algunos parÃ¡metros para ver como evoluciona
# en funciÃ³n de las iteraciones

xgbmgrid<-expand.grid(eta=c(0.03),
                      min_child_weight=c(20),
                      nrounds=c(70,100,150,200,300),
                      max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

set.seed(12345)
control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

plot(xgbm,ylim=c(0.84,0.86))


#Variables del segundo grupo 
# ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1


set.seed(12345)

xgbmgrid<-expand.grid(
  min_child_weight=c(5,10,20),
  eta=c(0.1,0.05,0.03,0.01,0.001),
  nrounds=c(100,500,1000,5000),
  max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm2<- train(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
              method="xgbTree",trControl=control,
              tuneGrid=xgbmgrid,verbose=FALSE)

xgbm2

plot(xgbm2)

# ESTUDIO DE EARLY STOPPING
# Probamos a fijar algunos parÃ¡metros para ver como evoluciona
# en funciÃ³n de las iteraciones

xgbmgrid<-expand.grid(eta=c(0.01),
                      min_child_weight=c(10),
                      nrounds=c(200,300,400,500,600),
                      max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

set.seed(12345)
control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

plot(xgbm,ylim=c(0.85,0.86))

#Variables del tercer grupo 
# al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1
set.seed(12345)

xgbmgrid<-expand.grid(
  min_child_weight=c(5,10,20),
  eta=c(0.1,0.05,0.03,0.01,0.001),
  nrounds=c(100,500,1000,5000),
  max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm3<- train(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
              method="xgbTree",trControl=control,
              tuneGrid=xgbmgrid,verbose=FALSE)

xgbm3

plot(xgbm3)




# ESTUDIO DE EARLY STOPPING
# Probamos a fijar algunos parÃ¡metros para ver como evoluciona
# en funciÃ³n de las iteraciones

xgbmgrid<-expand.grid(eta=c(0.01),
                      min_child_weight=c(10),
                      nrounds=c(300,400,500,600,700),
                      max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

set.seed(12345)
control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,data=datoscompletos1,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

plot(xgbm,ylim=c(0.85,0.86))




#Variables del cuarto grupo 
# ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0
set.seed(12345)

xgbmgrid<-expand.grid(
  min_child_weight=c(5,10,20),
  eta=c(0.1,0.05,0.03,0.01,0.001),
  nrounds=c(100,500,1000,5000),
  max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm4<- train(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
              method="xgbTree",trControl=control,
              tuneGrid=xgbmgrid,verbose=FALSE)

xgbm4

plot(xgbm4)


# ESTUDIO DE EARLY STOPPING
# Probamos a fijar algunos parÃ¡metros para ver como evoluciona
# en funciÃ³n de las iteraciones

xgbmgrid<-expand.grid(eta=c(0.03),
                      min_child_weight=c(10),
                      nrounds=c(60,70,80,90,100,110,120,130,140,150,200),
                      max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

set.seed(12345)
control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,data=datoscompletos1,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

plot(xgbm,ylim=c(0.84,0.85))



#Variables del quinto grupo 
# ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1
set.seed(12345)

xgbmgrid<-expand.grid(
  min_child_weight=c(5,10,20),
  eta=c(0.1,0.05,0.03,0.01,0.001),
  nrounds=c(100,500,1000,5000),
  max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm5<- train(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,data=datoscompletos1,
              method="xgbTree",trControl=control,
              tuneGrid=xgbmgrid,verbose=FALSE)

xgbm5

plot(xgbm5)


# ESTUDIO DE EARLY STOPPING
# Probamos a fijar algunos parÃ¡metros para ver como evoluciona
# en funciÃ³n de las iteraciones

xgbmgrid<-expand.grid(eta=c(0.03),
                      min_child_weight=c(10),
                      nrounds=c(60,70,80,90,100,110,120,130,140,150,200),
                      max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

set.seed(12345)
control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,data=datoscompletos1,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

plot(xgbm,ylim=c(0.84,0.86))



#Variables del octavo grupo
# aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3
set.seed(12345)

xgbmgrid<-expand.grid(
  min_child_weight=c(5,10,20),
  eta=c(0.1,0.05,0.03,0.01,0.001),
  nrounds=c(100,500,1000,5000),
  max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm8<- train(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,data=datoscompletos1,
              method="xgbTree",trControl=control,
              tuneGrid=xgbmgrid,verbose=FALSE)

xgbm8

plot(xgbm8)


# ESTUDIO DE EARLY STOPPING
# Probamos a fijar algunos parÃ¡metros para ver como evoluciona
# en funciÃ³n de las iteraciones

xgbmgrid<-expand.grid(eta=c(0.03),
                      min_child_weight=c(5),
                      nrounds=c(60,70,80,90,100,110,120,130,140,150,200),
                      max_depth=6,gamma=0,colsample_bytree=1,subsample=1)

set.seed(12345)
control<-trainControl(method = "cv",number=4,savePredictions = "all",
                      classProbs=TRUE) 

xgbm<- train(factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,data=datoscompletos1,
             method="xgbTree",trControl=control,
             tuneGrid=xgbmgrid,verbose=FALSE)

plot(xgbm,ylim=c(0.84,0.86))


# MODELOS

#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

medias65<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.03,nrounds=100,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias65$modelo="xgbm1.1"

# Imitacion parametros gbm
medias66<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=15,eta=0.05,nrounds=500,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias66$modelo="xgbm1.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias67<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.03,nrounds=300,max_depth=6,
                         gamma=0,colsample_bytree=0.8,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias67$modelo="xgbm1.3"

# Sorteamos muestra
medias68<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.03,nrounds=300,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=0.8,
                         alpha=0,lambda=0,lambda_bias=0)

medias68$modelo="xgbm1.4"

# Sorteamos variables y muestra con otros porcentaje
medias69<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.03,nrounds=300,max_depth=6,
                         gamma=0,colsample_bytree=0.85,subsample=0.85,
                         alpha=0,lambda=0,lambda_bias=0)

medias69$modelo="xgbm1.5"


union8<-rbind(medias65,medias66,medias67,medias68,medias69)

par(cex.axis=0.5,cex=1)
boxplot(data=union8,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union8,auc~modelo,main="AUC",col="pink")



# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias65<-cruzadaxgbmbin(data=datoscompletos, vardep="salary_50k",
                         listconti=c("fnlwgt","capital_loss","capital_gain","age","education_num","hours_per_week","marital.Divorced","marital.Married","relationship.Husband","relationship.Ownchild","native_country.Si","occupation.Execmanagerial","occupation.Machineopinspct","occupation.Otherservice","occupation.Profspecialty","workclass.Otro"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.03,nrounds=100,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=10,lambda_bias=0)

medias65$modelo="xgbm1.6"


union11<-rbind(medias60,medias61,medias62,medias63,medias64,medias65)

par(cex.axis=0.6,cex=1)
boxplot(data=union11,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union11,auc~modelo,main="AUC",col="pink")


#Variables del segundo grupo 
# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"

medias71<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=300,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias71$modelo="xgbm2.1"

# Imitacion parametros gbm
medias72<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=25,eta=0.01,nrounds=900,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias72$modelo="xgbm2.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias73<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=400,max_depth=6,
                         gamma=0,colsample_bytree=0.8,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias73$modelo="xgbm2.3"

# Sorteamos muestra
medias74<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=400,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=0.8,
                         alpha=0,lambda=0,lambda_bias=0)

medias74$modelo="xgbm2.4"

# Sorteamos variables y muestra con otros porcentaje
medias75<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=400,max_depth=6,
                         gamma=0,colsample_bytree=0.85,subsample=0.85,
                         alpha=0,lambda=0,lambda_bias=0)

medias75$modelo="xgbm2.5"

# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias76<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=400,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=10,lambda_bias=0)

medias76$modelo="xgbm2.6"

union9<-rbind(medias71,medias72,medias73,medias74,medias75,medias76)

par(cex.axis=0.5,cex=1)
boxplot(data=union9,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union9,auc~modelo,main="AUC",col="pink")


#Variables del tercer grupo 
# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			
medias77<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=400,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias77$modelo="xgbm3.1"

# Imitacion parametros gbm
medias78<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=15,eta=0.05,nrounds=500,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias78$modelo="xgbm3.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias79<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=600,max_depth=6,
                         gamma=0,colsample_bytree=0.8,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias79$modelo="xgbm3.3"

# Sorteamos muestra
medias80<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=600,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=0.8,
                         alpha=0,lambda=0,lambda_bias=0)

medias80$modelo="xgbm3.4"

# Sorteamos variables y muestra con otros porcentaje
medias81<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=600,max_depth=6,
                         gamma=0,colsample_bytree=0.85,subsample=0.85,
                         alpha=0,lambda=0,lambda_bias=0)

medias81$modelo="xgbm3.5"

# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias82<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.01,nrounds=600,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=10,lambda_bias=0)

medias82$modelo="xgbm3.6"

union10<-rbind(medias77,medias78,medias79,medias80,medias81,medias82)

par(cex.axis=0.5,cex=1)
boxplot(data=union10,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union10,auc~modelo,main="AUC",col="pink")

#Variables del cuarto grupo 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															
medias83<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.01,nrounds=140,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias83$modelo="xgbm4.1"

# Imitacion parametros gbm
medias84<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=15,eta=0.1,nrounds=60,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias84$modelo="xgbm4.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias85<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.01,nrounds=250,max_depth=6,
                         gamma=0,colsample_bytree=0.8,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias85$modelo="xgbm4.3"

# Sorteamos muestra
medias86<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.01,nrounds=250,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=0.8,
                         alpha=0,lambda=0,lambda_bias=0)

medias86$modelo="xgbm4.4"

# Sorteamos variables y muestra con otros porcentaje
medias87<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.01,nrounds=250,max_depth=6,
                         gamma=0,colsample_bytree=0.85,subsample=0.85,
                         alpha=0,lambda=0,lambda_bias=0)

medias87$modelo="xgbm4.5"

# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias88<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=20,eta=0.01,nrounds=250,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=10,lambda_bias=0)

medias88$modelo="xgbm4.6"

union11<-rbind(medias83,medias84,medias85,medias86,medias87,medias88)

par(cex.axis=0.5,cex=1)
boxplot(data=union11,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union11,auc~modelo,main="AUC",col="pink")

#Variables del quinto grupo 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				
medias89<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=100,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias89$modelo="xgbm5.1"

# Imitacion parametros gbm
medias90<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=15,eta=0.1,nrounds=90,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias90$modelo="xgbm5.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias91<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                         gamma=0,colsample_bytree=0.8,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias91$modelo="xgbm5.3"

# Sorteamos muestra
medias92<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=0.8,
                         alpha=0,lambda=0,lambda_bias=0)

medias92$modelo="xgbm5.4"

# Sorteamos variables y muestra con otros porcentaje
medias93<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                         gamma=0,colsample_bytree=0.85,subsample=0.85,
                         alpha=0,lambda=0,lambda_bias=0)

medias93$modelo="xgbm5.5"

# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias94<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=10,lambda_bias=0)

medias94$modelo="xgbm5.6"

union12<-rbind(medias89,medias90,medias91,medias92,medias93,medias94)

par(cex.axis=0.5,cex=1)
boxplot(data=union12,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union12,auc~modelo,main="AUC",col="pink")

#Variables del sexto grupo 
# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		
medias95<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=100,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias95$modelo="xgbm6.1"

# Imitacion parametros gbm
medias96<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=15,eta=0.1,nrounds=90,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias96$modelo="xgbm6.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias97<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                         gamma=0,colsample_bytree=0.8,subsample=1,
                         alpha=0,lambda=0,lambda_bias=0)

medias97$modelo="xgbm6.3"

# Sorteamos muestra
medias98<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                         gamma=0,colsample_bytree=1,subsample=0.8,
                         alpha=0,lambda=0,lambda_bias=0)

medias98$modelo="xgbm6.4"

# Sorteamos variables y muestra con otros porcentaje
medias99<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,
                         min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                         gamma=0,colsample_bytree=0.85,subsample=0.85,
                         alpha=0,lambda=0,lambda_bias=0)

medias99$modelo="xgbm6.5"

# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias100<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=1,
                          alpha=0,lambda=10,lambda_bias=0)

medias100$modelo="xgbm6.6"

union13<-rbind(medias95,medias96,medias97,medias98,medias99,medias100)

par(cex.axis=0.5,cex=1)
boxplot(data=union13,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union13,auc~modelo,main="AUC",col="pink")

#Variables del septimo grupo 
# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			
medias101<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=10,eta=0.03,nrounds=100,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=1,
                          alpha=0,lambda=0,lambda_bias=0)

medias101$modelo="xgbm7.1"

# Imitacion parametros gbm
medias102<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=15,eta=0.1,nrounds=90,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=1,
                          alpha=0,lambda=0,lambda_bias=0)

medias102$modelo="xgbm7.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias103<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=0.8,subsample=1,
                          alpha=0,lambda=0,lambda_bias=0)

medias103$modelo="xgbm7.3"

# Sorteamos muestra
medias104<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=0.8,
                          alpha=0,lambda=0,lambda_bias=0)

medias104$modelo="xgbm7.4"

# Sorteamos variables y muestra con otros porcentaje
medias105<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=0.85,subsample=0.85,
                          alpha=0,lambda=0,lambda_bias=0)

medias105$modelo="xgbm7.5"

# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias106<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=10,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=1,
                          alpha=0,lambda=10,lambda_bias=0)

medias106$modelo="xgbm7.6"

union14<-rbind(medias101,medias102,medias103,medias104,medias105,medias106)

par(cex.axis=0.5,cex=1)
boxplot(data=union14,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union14,auc~modelo,main="AUC",col="pink")

#Variables del octavo grupo
# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														
medias107<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=5,eta=0.03,nrounds=100,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=1,
                          alpha=0,lambda=0,lambda_bias=0)

medias107$modelo="xgbm8.1"

# Imitacion parametros gbm
medias108<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=25,eta=0.05,nrounds=700,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=1,
                          alpha=0,lambda=0,lambda_bias=0)

medias108$modelo="xgbm8.2"


# PARA REDUCIR LA VARIANZA SE PUEDE RECURRIR A SORTEAR VARIABLES
# (ESTILO RANDOMFOREST PERO ANTES DEL ARBOL) Y/O
# A SORTEAR OBSERVACIONES (BAGGING)
# EN AMBOS CASOS HAY QUE AUMENTAR EL NÃMERO DE ÃRBOLES

# Sorteamos variables 
medias109<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=5,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=0.8,subsample=1,
                          alpha=0,lambda=0,lambda_bias=0)

medias109$modelo="xgbm8.3"

# Sorteamos muestra
medias110<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=5,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=0.8,
                          alpha=0,lambda=0,lambda_bias=0)

medias110$modelo="xgbm8.4"

# Sorteamos variables y muestra con otros porcentaje
medias111<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=5,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=0.85,subsample=0.85,
                          alpha=0,lambda=0,lambda_bias=0)

medias111$modelo="xgbm8.5"

# PODEMOS PROBAR AÃADIR REGULARIZACIÃN AL MEJOR MODELO XGBM

medias112<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
                          listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""),
                          grupos=4,sinicio=1234,repe=5,
                          min_child_weight=5,eta=0.03,nrounds=200,max_depth=6,
                          gamma=0,colsample_bytree=1,subsample=1,
                          alpha=0,lambda=10,lambda_bias=0)

medias112$modelo="xgbm8.6"

union15<-rbind(medias107,medias108,medias109,medias110,medias111,medias112)

par(cex.axis=0.5,cex=1)
boxplot(data=union15,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union15,auc~modelo,main="AUC",col="pink")

#Comparamos los mejores modelos XGBM
union100<-rbind(medias65,	medias66,	medias67,	medias68,	medias69,	medias70,	medias71,	medias72,	medias73,	medias74,	medias75,	medias76,	medias77,	medias78,	medias79,	medias80,	medias81,	medias82,	medias83,	medias84,	medias85,	medias86,	medias87,	medias88,	medias89,	medias90,	medias91,	medias92,	medias93,	medias94,	medias95,	medias96,	medias97,	medias98,	medias99,	medias100,	medias101,	medias102,	medias103,	medias104,	medias105,	medias106,	medias107,	medias108,	medias109,	medias110,	medias111,	medias112)

par(cex.axis=0.5,cex=1)
boxplot(data=union100,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union100,auc~modelo,main="AUC",col="pink")

#Ordeno el gráfico
uni<-union100
uni$modelo <- with(uni,
                   reorder(modelo,tasa, median))
par(cex.axis=1.2,las=2)
boxplot(data=uni,tasa~modelo,col="pink",main="TASA FALLOS")

uni<-union100
uni$modelo <- with(uni,
                   reorder(modelo,auc, median))
par(cex.axis=1.2,las=2)
boxplot(data=uni,auc~modelo,col="pink",main="AUC")

#Comparamos los mejores modelos XGBM
union101<-rbind(medias66,	medias67,	medias68,	medias69)

par(cex.axis=0.8,cex=1,2)
boxplot(data=union101,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union101,auc~modelo,main="AUC",col="pink")


##############################
#SUPPORT VECTOR MACHINE (SVM)#
##############################


#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														
# aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

#  SVM LINEAL: SOLO PARÃMETRO C

set.seed(12345)
SVMgrid<-expand.grid(C=c(0.001,0.01,0.05,0.1,0.2,0.5,1,2,5,10))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM<- train(data=datoscompletos1,factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM$results
plot(SVM$results$C,SVM$results$Accuracy)

# Rehago el grid para observar mejor el intervalo de C entre 0 y 0.6
SVMgrid<-expand.grid(C=c(0.01,0.02,0.03,0.04,0.05,0.8,0.1,0.2,0.3,0.4,0.5,0.6))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM<- train(data=datoscompletos1,factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM$results
plot(SVM$results$C,SVM$results$Accuracy)


#  SVM Polinomial: PARAMETROS C, degree, scale

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10),
                     degree=c(2,3),scale=c(0.1,0.5,1,2,5))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM<- train(data=datoscompletos1,factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmPoly",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM

SVM$results

# LOS GRÃFICOS DOS A DOS NO SIRVEN
# plot(SVM$results$C,SVM$results$Accuracy)
# plot(SVM$results$degree,SVM$results$Accuracy)
# plot(SVM$results$scale,SVM$results$Accuracy)

dat<-as.data.frame(SVM$results)
library(ggplot2)

# PLOT DE DOS VARIABLES CATEGÃRICAS, UNA CONTINUA
ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(degree),pch=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)


# SOLO DEGREE=2
dat2<-dat[dat$degree==2,]  

ggplot(dat2, aes(x=factor(C), y=Accuracy, 
                 colour=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

#  SVM RBF: PARÃMETROS C, sigma

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30),
                     sigma=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM<- train(data=datoscompletos1,factor(b)~aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmRadial",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM

dat<-as.data.frame(SVM$results)

ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(sigma)))+ 
  geom_point(position=position_dodge(width=0.5),size=3)




#Variables del segundo grupo 
# ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1

#  SVM LINEAL: SOLO PARÃMETRO C

set.seed(12345)
SVMgrid<-expand.grid(C=c(0.001,0.01,0.05,0.1,0.2,0.5,1,2,5,10))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM2<- train(data=datoscompletos1,factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM2$results
plot(SVM2$results$C,SVM2$results$Accuracy)

# Rehago el grid para observar mejor el intervalo de C entre 0 y 0.6
SVMgrid<-expand.grid(C=c(0.01,0.02,0.03,0.04,0.05,0.8,0.1,0.2,0.3,0.4,0.5,0.6))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM2<- train(data=datoscompletos1,factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM2$results
plot(SVM2$results$C,SVM2$results$Accuracy)


#  SVM Polinomial: PARAMETROS C, degree, scale

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10),
                     degree=c(2,3),scale=c(0.1,0.5,1,2,5))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM2<- train(data=datoscompletos1,factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmPoly",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM2

SVM2$results

# LOS GRÃFICOS DOS A DOS NO SIRVEN
# plot(SVM$results$C,SVM$results$Accuracy)
# plot(SVM$results$degree,SVM$results$Accuracy)
# plot(SVM$results$scale,SVM$results$Accuracy)

dat<-as.data.frame(SVM2$results)
library(ggplot2)

# PLOT DE DOS VARIABLES CATEGÃRICAS, UNA CONTINUA
ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(degree),pch=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

# SOLO DEGREE=2
dat2<-dat[dat$degree==2,]  

ggplot(dat2, aes(x=factor(C), y=Accuracy, 
                 colour=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

#  SVM RBF: PARÃMETROS C, sigma

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30),
                     sigma=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM3<- train(data=datoscompletos1,factor(b)~ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmRadial",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM3

dat<-as.data.frame(SVM3$results)

ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(sigma)))+ 
  geom_point(position=position_dodge(width=0.5),size=3)


#Variables del tercer grupo 
# al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1

#  SVM LINEAL: SOLO PARÃMETRO C

set.seed(12345)
SVMgrid<-expand.grid(C=c(0.001,0.01,0.05,0.1,0.2,0.5,1,2,5,10))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM4<- train(data=datoscompletos1,factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM4$results
plot(SVM4$results$C,SVM4$results$Accuracy)

# Rehago el grid para observar mejor el intervalo de C entre 0 y 0.6
SVMgrid<-expand.grid(C=c(0.01,0.02,0.03,0.04,0.05,0.8,0.1,0.2,0.3,0.4,0.5,0.6))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM5<- train(data=datoscompletos1,factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM5$results
plot(SVM5$results$C,SVM5$results$Accuracy)


#  SVM Polinomial: PARAMETROS C, degree, scale

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10),
                     degree=c(2,3),scale=c(0.1,0.5,1,2,5))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM6<- train(data=datoscompletos1,factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmPoly",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM6

SVM6$results

# LOS GRÃFICOS DOS A DOS NO SIRVEN
# plot(SVM$results$C,SVM$results$Accuracy)
# plot(SVM$results$degree,SVM$results$Accuracy)
# plot(SVM$results$scale,SVM$results$Accuracy)

dat<-as.data.frame(SVM6$results)
library(ggplot2)

# PLOT DE DOS VARIABLES CATEGÃRICAS, UNA CONTINUA
ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(degree),pch=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

# SOLO DEGREE=2
dat2<-dat[dat$degree==2,]  

ggplot(dat2, aes(x=factor(C), y=Accuracy, 
                 colour=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

#  SVM RBF: PARÃMETROS C, sigma

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30),
                     sigma=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM7<- train(data=datoscompletos1,factor(b)~al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1,
            method="svmRadial",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM7

dat<-as.data.frame(SVM7$results)

ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(sigma)))+ 
  geom_point(position=position_dodge(width=0.5),size=3)


#Variables del cuarto grupo 
# ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

#  SVM LINEAL: SOLO PARÃMETRO C

set.seed(12345)
SVMgrid<-expand.grid(C=c(0.001,0.01,0.05,0.1,0.2,0.5,1,2,5,10))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM8<- train(data=datoscompletos1,factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM8$results
plot(SVM8$results$C,SVM8$results$Accuracy)

# Rehago el grid para observar mejor el intervalo de C entre 0 y 0.6
SVMgrid<-expand.grid(C=c(0.01,0.02,0.03,0.04,0.05,0.8,0.1,0.2,0.3,0.4,0.5,0.6))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM9<- train(data=datoscompletos1,factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM9$results
plot(SVM9$results$C,SVM9$results$Accuracy)


#  SVM Polinomial: PARAMETROS C, degree, scale

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10),
                     degree=c(2,3),scale=c(0.1,0.5,1,2,5))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM10<- train(data=datoscompletos1,factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmPoly",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM10

SVM10$results

# LOS GRÃFICOS DOS A DOS NO SIRVEN
# plot(SVM$results$C,SVM$results$Accuracy)
# plot(SVM$results$degree,SVM$results$Accuracy)
# plot(SVM$results$scale,SVM$results$Accuracy)

dat<-as.data.frame(SVM10$results)
library(ggplot2)

# PLOT DE DOS VARIABLES CATEGÃRICAS, UNA CONTINUA
ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(degree),pch=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

# SOLO DEGREE=2
dat2<-dat[dat$degree==2,]  

ggplot(dat2, aes(x=factor(C), y=Accuracy, 
                 colour=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

#  SVM RBF: PARÃMETROS C, sigma

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30),
                     sigma=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM11<- train(data=datoscompletos1,factor(b)~ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0,
            method="svmRadial",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM11

dat<-as.data.frame(SVM11$results)

ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(sigma)))+ 
  geom_point(position=position_dodge(width=0.5),size=3)


#Variables del quinto grupo 
# ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1

#  SVM LINEAL: SOLO PARÃMETRO C

set.seed(12345)
SVMgrid<-expand.grid(C=c(0.001,0.01,0.05,0.1,0.2,0.5,1,2,5,10))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM12<- train(data=datoscompletos1,factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM12$results
plot(SVM12$results$C,SVM12$results$Accuracy)

# Rehago el grid para observar mejor el intervalo de C entre 0 y 0.6
SVMgrid<-expand.grid(C=c(0.01,0.02,0.03,0.04,0.05,0.8,0.1,0.2,0.3,0.4,0.5,0.6))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM13<- train(data=datoscompletos1,factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM13$results
plot(SVM13$results$C,SVM13$results$Accuracy)


#  SVM Polinomial: PARAMETROS C, degree, scale

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10),
                     degree=c(2,3),scale=c(0.1,0.5,1,2,5))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM14<- train(data=datoscompletos1,factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
            method="svmPoly",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM14

SVM14$results

# LOS GRÃFICOS DOS A DOS NO SIRVEN
# plot(SVM$results$C,SVM$results$Accuracy)
# plot(SVM$results$degree,SVM$results$Accuracy)
# plot(SVM$results$scale,SVM$results$Accuracy)

dat<-as.data.frame(SVM14$results)
library(ggplot2)

# PLOT DE DOS VARIABLES CATEGÃRICAS, UNA CONTINUA
ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(degree),pch=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

# SOLO DEGREE=2
dat2<-dat[dat$degree==2,]  

ggplot(dat2, aes(x=factor(C), y=Accuracy, 
                 colour=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

#  SVM RBF: PARÃMETROS C, sigma

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30),
                     sigma=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM15<- train(data=datoscompletos1,factor(b)~ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1,
            method="svmRadial",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM15

dat<-as.data.frame(SVM15$results)

ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(sigma)))+ 
  geom_point(position=position_dodge(width=0.5),size=3)


#Variables del octavo grupo
# aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3
#  SVM LINEAL: SOLO PARÃMETRO C

set.seed(12345)
SVMgrid<-expand.grid(C=c(0.001,0.01,0.05,0.1,0.2,0.5,1,2,5,10))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM16<- train(data=datoscompletos1,factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM16$results
plot(SVM16$results$C,SVM16$results$Accuracy)

# Rehago el grid para observar mejor el intervalo de C entre 0 y 0.6
SVMgrid<-expand.grid(C=c(0.01,0.02,0.03,0.04,0.05,0.8,0.1,0.2,0.3,0.4,0.5,0.6))

control<-trainControl(method = "cv",number=4,savePredictions = "all") 

SVM17<- train(data=datoscompletos1,factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,
            method="svmLinear",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM17$results
plot(SVM17$results$C,SVM17$results$Accuracy)


#  SVM Polinomial: PARAMETROS C, degree, scale

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10),
                     degree=c(2,3),scale=c(0.1,0.5,1,2,5))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM18<- train(data=datoscompletos1,factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,
            method="svmPoly",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM18

SVM18$results

# LOS GRÃFICOS DOS A DOS NO SIRVEN
# plot(SVM$results$C,SVM$results$Accuracy)
# plot(SVM$results$degree,SVM$results$Accuracy)
# plot(SVM$results$scale,SVM$results$Accuracy)

dat<-as.data.frame(SVM18$results)
library(ggplot2)

# PLOT DE DOS VARIABLES CATEGÃRICAS, UNA CONTINUA
ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(degree),pch=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

# SOLO DEGREE=2
dat2<-dat[dat$degree==2,]  

ggplot(dat2, aes(x=factor(C), y=Accuracy, 
                 colour=factor(scale))) +
  geom_point(position=position_dodge(width=0.5),size=3)

#  SVM RBF: PARÃMETROS C, sigma

SVMgrid<-expand.grid(C=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30),
                     sigma=c(0.01,0.05,0.1,0.2,0.5,1,2,5,10,30))

control<-trainControl(method = "cv",
                      number=4,savePredictions = "all") 


SVM19<- train(data=datoscompletos1,factor(b)~aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3,
            method="svmRadial",trControl=control,
            tuneGrid=SVMgrid,verbose=FALSE)

SVM19

dat<-as.data.frame(SVM19$results)

ggplot(dat, aes(x=factor(C), y=Accuracy, 
                color=factor(sigma)))+ 
  geom_point(position=position_dodge(width=0.5),size=3)




# MODELOS

#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

medias113<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                        listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,C=0.03)

medias113$modelo="SVM1"


medias114<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                            listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5,
                            C=0.01,degree=1,scale=0.1)

medias114$modelo="SVMPoly1"


medias115<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                           listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                           listclass=c(""),
                           grupos=4,sinicio=1234,repe=5, 
                           C=2,sigma=0.01)

medias115$modelo="SVMRBF1"

#Variables del segundo grupo 
#"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"

medias116<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                         listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,C=0.04)

medias116$modelo="SVM2"


medias117<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                             listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                             listclass=c(""),
                             grupos=4,sinicio=1234,repe=5,
                             C=0.01,degree=1,scale=0.1)

medias117$modelo="SVMPoly2"


medias118<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias118$modelo="SVMRBF2"



#Variables del tercer grupo 
# "al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			

medias119<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                         listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,C=0.02)

medias119$modelo="SVM3"


medias120<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                             listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                             listclass=c(""),
                             grupos=4,sinicio=1234,repe=5,
                             C=0.01,degree=1,scale=0.1)

medias120$modelo="SVMPoly3"


medias121<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias121$modelo="SVMRBF3"

#Variables del cuarto grupo 
# "ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															

medias122<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                         listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,C=0.02)

medias122$modelo="SVM4"


medias123<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                             listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                             listclass=c(""),
                             grupos=4,sinicio=1234,repe=5,
                             C=0.01,degree=1,scale=0.1)

medias123$modelo="SVMPoly4"


medias124<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias124$modelo="SVMRBF4"

#Variables del quinto grupo 
# "ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				

medias125<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,C=0.02)

medias125$modelo="SVM5"


medias126<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                             listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                             listclass=c(""),
                             grupos=4,sinicio=1234,repe=5,
                             C=0.01,degree=1,scale=0.1)

medias126$modelo="SVMPoly5"


medias127<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias127$modelo="SVMRBF5"

#Variables del sexto grupo 
# "ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		

medias128<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,C=0.02)

medias128$modelo="SVM6"


medias129<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                             listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                             listclass=c(""),
                             grupos=4,sinicio=1234,repe=5,
                             C=0.01,degree=1,scale=0.1)

medias129$modelo="SVMPoly6"


medias130<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias130$modelo="SVMRBF6"

#Variables del septimo grupo 
# "ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			

medias131<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                         listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,C=0.02)

medias131$modelo="SVM7"


medias132<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                             listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                             listclass=c(""),
                             grupos=4,sinicio=1234,repe=5,
                             C=0.01,degree=1,scale=0.1)

medias132$modelo="SVMPoly7"


medias133<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias133$modelo="SVMRBF7"

#Variables del octavo grupo
# "aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														

medias134<-cruzadaSVMbin(data=datoscompletos, vardep="b",
                         listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                         listclass=c(""),
                         grupos=4,sinicio=1234,repe=5,C=0.02)

medias134$modelo="SVM8"


medias135<-cruzadaSVMbinPoly(data=datoscompletos, vardep="b",
                             listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                             listclass=c(""),
                             grupos=4,sinicio=1234,repe=5,
                             C=0.01,degree=1,scale=0.1)

medias135$modelo="SVMPoly8"


medias136<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias136$modelo="SVMRBF8"


union15<-rbind(medias113,	medias114,	medias115,	medias116,	medias117,	medias118,	medias119,	medias120,	medias121,	medias122,	medias123,	medias124,	medias125,	medias126,	medias127,	medias128,	medias129,	medias130,	medias131,	medias132,	medias133,	medias134,	medias135,	medias136)

par(cex.axis=0.7)
boxplot(data=union15,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union15,auc~modelo,main="AUC",col="pink")


#Ordeno el gráfico
uni<-union15
uni$modelo <- with(uni,
                   reorder(modelo,tasa, median))
par(cex.axis=0.8,las=2)
boxplot(data=uni,tasa~modelo,col="pink",main="TASA FALLOS")

uni<-union15
uni$modelo <- with(uni,
                   reorder(modelo,auc, median))
par(cex.axis=1.2,las=2)
boxplot(data=uni,auc~modelo,col="pink",main="AUC")





#############################
#COMPARACION MEJORES MODELOS#
#############################


union16<-rbind(medias2,medias16,medias19,medias26,medias45,medias57,medias69,medias122)

par(cex.axis=0.9)
boxplot(data=union16,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union16,auc~modelo,main="AUC",col="pink")


#Ordeno el gráfico
uni<-union16
uni$modelo <- with(uni,
                   reorder(modelo,tasa, median))
par(cex.axis=0.8,las=2)
boxplot(data=uni,tasa~modelo,col="pink",main="TASA FALLOS")

uni<-union16
uni$modelo <- with(uni,
                   reorder(modelo,auc, median))
par(cex.axis=1.2,las=2)
boxplot(data=uni,auc~modelo,col="pink",main="AUC")


 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"

# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			
 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															
 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				

# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		

# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			

# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														




#######################################
#COMPARAR MODELOS OTRA SEMILLA 1 (9813)
#######################################


medias137<-cruzadalogistica(data=datoscompletos,																																																																																
                          vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                          listclass=c(""),	grupos=4,sinicio=12,repe=5)																																																																														

medias137$modelo="Logistica2"																																																																																

medias138<-cruzadaarbolbin(data=datoscompletos,																																																																																
                          vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                          listclass=c(""),grupos=4,sinicio=9813,repe=10,																																																																															
                          cp=c(0),minbucket	=5)																																																																														

medias138$modelo="arbol8"																																																																																

medias139<-cruzadaavnnetbin(data=datoscompletos,																																																																																
                           vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),			
                           listclass=c(""),grupos=4,sinicio=9813,repe=10,																																																																															
                           size=c(4),decay=c(0.2),repeticiones=5,itera=50)																																																																															

medias139$modelo="REDES3"																																																																																
																																																																										
medias140<-cruzadarfbin(data=datoscompletos,																																																																																
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),														
                       listclass=c(""),																																																																															
                       grupos=4,sinicio=9813,repe=10,nodesize=20,																																																																															
                       mtry=66,ntree=450,sampsize=2500,replace=FALSE)	#sampsize=2500																																																																														

medias140$modelo="BAG1.2"																																																																																

medias141<-cruzadarfbin(data=datoscompletos,																																																																																
                       vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),																															
                       listclass=c(""),																																																																															
                       grupos=4,sinicio=9813,repe=5,nodesize=20,																																																																															
                       mtry=8,ntree=150,sampsize=2500,replace=TRUE)	#sampsize=2500																																																																														

medias141$modelo="rf4.1"																																																																																

medias142<-cruzadagbmbin(data=datoscompletos,	vardep="b",																																																																															
                        listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),														
                        listclass=c(""),																																																																															
                        grupos=4,sinicio=9813,repe=5,																																																																															
                        n.minobsinnode=15,shrinkage=0.05,n.trees=500,interaction.depth=2)																																																																															

medias142$modelo="gbm1"																																																																																

medias143<-cruzadaxgbmbin(data=datoscompletos,	vardep="b",																																																																															
                         listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),														
                         listclass=c(""),																																																																															
                         grupos=4,sinicio=9813,repe=5,																																																																															
                         min_child_weight=20,eta=0.03,nrounds=300,max_depth=6,																																																																															
                         gamma=0,colsample_bytree=0.85,subsample=0.85,																																																																															
                         alpha=0,lambda=0,lambda_bias=0)																																																																															

medias143$modelo="xgbm1.5"																																																																																

medias144<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                              listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                              listclass=c(""),
                              grupos=4,sinicio=1234,repe=5, 
                              C=2,sigma=0.01)

medias144$modelo="SVMRBF1"


union17<-rbind(medias137,medias138,medias139,medias140,medias141,medias142,medias143,medias144)

par(cex.axis=0.9)
boxplot(data=union17,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union17,auc~modelo,main="AUC",col="pink")


#Ordeno el gráfico
uni<-union17
uni$modelo <- with(uni,
                   reorder(modelo,tasa, median))
par(cex.axis=0.8,las=2)
boxplot(data=uni,tasa~modelo,col="pink",main="TASA FALLOS")

uni<-union17
uni$modelo <- with(uni,
                   reorder(modelo,auc, median))
par(cex.axis=1.2,las=2)
boxplot(data=uni,auc~modelo,col="pink",main="AUC")



#######################################
#COMPARAR MODELOS OTRA SEMILLA 1 (5988)
#######################################

medias145<-cruzadalogistica(data=datoscompletos,																																																																																
                            vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                            listclass=c(""),	grupos=4,sinicio=5988,repe=10)																																																																														

medias145$modelo="Logistica2"																																																																																

medias146<-cruzadaarbolbin(data=datoscompletos,																																																																																
                           vardep="b",listconti=c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"),
                           listclass=c(""),grupos=4,sinicio=5988,repe=10,																																																																															
                           cp=c(0),minbucket	=5)																																																																														

medias146$modelo="arbol8"																																																																																

medias147<-cruzadaavnnetbin(data=datoscompletos,																																																																																
                            vardep="b",listconti=c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),			
                            listclass=c(""),grupos=4,sinicio=5988,repe=10,																																																																															
                            size=c(4),decay=c(0.2),repeticiones=5,itera=50)																																																																															

medias147$modelo="REDES3"																																																																																

medias148<-cruzadarfbin(data=datoscompletos,																																																																																
                        vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),														
                        listclass=c(""),																																																																															
                        grupos=4,sinicio=5988,repe=10,nodesize=20,																																																																															
                        mtry=66,ntree=450,sampsize=2500,replace=FALSE)	#sampsize=2500																																																																														

medias148$modelo="BAG1.2"																																																																																

medias149<-cruzadarfbin(data=datoscompletos,																																																																																
                        vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),																															
                        listclass=c(""),																																																																															
                        grupos=4,sinicio=5988,repe=5,nodesize=20,																																																																															
                        mtry=8,ntree=150,sampsize=2500,replace=TRUE)	#sampsize=2500																																																																														

medias149$modelo="rf4.1"																																																																																

medias150<-cruzadagbmbin(data=datoscompletos,	vardep="b",																																																																															
                         listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),														
                         listclass=c(""),																																																																															
                         grupos=4,sinicio=5988,repe=5,																																																																															
                         n.minobsinnode=15,shrinkage=0.05,n.trees=500,interaction.depth=2)																																																																															

medias150$modelo="gbm1"																																																																																

medias151<-cruzadaxgbmbin(data=datoscompletos,	vardep="b",																																																																															
                          listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),														
                          listclass=c(""),																																																																															
                          grupos=4,sinicio=5988,repe=5,																																																																															
                          min_child_weight=20,eta=0.03,nrounds=300,max_depth=6,																																																																															
                          gamma=0,colsample_bytree=0.85,subsample=0.85,																																																																															
                          alpha=0,lambda=0,lambda_bias=0)																																																																															

medias151$modelo="xgbm1.5"																																																																																

medias152<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias152$modelo="SVMRBF1"

union18<-rbind(medias145,medias146,medias147,medias148,medias149,medias150,medias151,medias152)

par(cex.axis=0.9)
boxplot(data=union18,tasa~modelo,main="TASA FALLOS",col="pink")
boxplot(data=union18,auc~modelo,main="AUC",col="pink")


#Ordeno el gráfico
par(mar = c(4.5, 4.5, 2,1))
uni<-union18
uni$modelo <- with(uni,
                   reorder(modelo,tasa, median))
par(cex.axis=0.8,las=2)
boxplot(data=uni,tasa~modelo,col="pink",main="TASA FALLOS")

uni<-union18
uni$modelo <- with(uni,
                   reorder(modelo,auc, median))
par(cex.axis=0.9,las=2)
boxplot(data=uni,auc~modelo,col="pink",main="AUC")




##########################
# TECNICAS DE ENSAMBLADO #
##########################

set.seed(12345)

archivo<-datoscompletos

vardep<-"b"
listconti<-c()
listclass<-c("")
grupos<-4
sinicio<-1234
repe<-5


#LOGISTICA 	LOGISTICA2	medias2

medias2<-cruzadalogistica(data=datoscompletos,
                          vardep="b",listconti=c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"),
                          listclass=c(""), grupos=4,sinicio=1234,repe=5)

medias2bis<-as.data.frame(medias2[1])
medias2bis$modelo<-"logi"
predi2<-as.data.frame(medias2[2])
predi2$logi<-predi2$Yes

#REDES NEURONALES	REDES3	medias19

medias19<-cruzadaavnnetbin(data=datoscompletos,
                           vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                           listclass=c(""),grupos=4,sinicio=1234,repe=5,
                           size=c(4),decay=c(0.2),repeticiones=5,itera=50)

medias19bis<-as.data.frame(medias19[1])
medias19bis$modelo<-"avnnet"
predi19<-as.data.frame(medias19[2])
predi19$avnnet<-predi19$Yes

#BAGGING	BAG1.2	medias26

medias26<-cruzadarfbin(data=datoscompletos, 
                       vardep="b",listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=66,ntree=450,sampsize=2500,replace=FALSE) #sampsize=2500

medias26bis<-as.data.frame(medias26[1])
medias26bis$modelo<-"bagg"
predi26<-as.data.frame(medias26[2])
predi26$bagg<-predi26$Yes

#RAMDON FOREST	RF4.1	medias45

medias45<-cruzadarfbin(data=datoscompletos,
                       vardep="b",listconti=c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                       listclass=c(""),
                       grupos=4,sinicio=1234,repe=5,nodesize=20,
                       mtry=8,ntree=50,sampsize=2500,replace=TRUE) #sampsize=2500

medias45bis<-as.data.frame(medias45[1])
medias45bis$modelo<-"RF"
predi45<-as.data.frame(medias45[2])
predi45$RF<-predi45$Yes

#GRADIENT BOOSTING MACHINE	GBM1	medias57

medias57<-cruzadagbmbin(data=datoscompletos, vardep="b",
                        listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                        listclass=c(""),
                        grupos=4,sinicio=1234,repe=5,
                        n.minobsinnode=15,shrinkage=0.05,n.trees=500,interaction.depth=2)

medias57bis<-as.data.frame(medias57[1])
medias57bis$modelo<-"GBM"
predi57<-as.data.frame(medias57[2])
predi57$GBM<-predi57$Yes

#XGBM	XGBM1.5	medias69

medias69<-cruzadaxgbmbin(data=datoscompletos, vardep="b",
               listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
               listclass=c(""),
               grupos=4,sinicio=1234,repe=5,
               min_child_weight=5,eta=0.03,nrounds=300,max_depth=6,
               gamma=0,colsample_bytree=0.85,subsample=0.85,
               alpha=0,lambda=0,lambda_bias=0)

medias69bis<-as.data.frame(medias69[1])
medias69bis$modelo<-"XGBM"
predi69<-as.data.frame(medias69[2])
predi69$XGBM<-predi69$Yes

#SVM	SVMRBF	medias115

medias115<-cruzadaSVMbinRBF(data=datoscompletos, vardep="b",
                            listconti=c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"),
                            listclass=c(""),
                            grupos=4,sinicio=1234,repe=5, 
                            C=2,sigma=0.01)

medias115bis<-as.data.frame(medias115[1])
medias115bis$modelo<-"SVMRBF"
predi115<-as.data.frame(medias115[2])
predi115$SVMRBF<-predi115$Yes


#######################
#COMPARACION DE MODELOS
#######################

union1<-rbind(medias2bis,medias19bis,medias26bis,medias45bis,medias57bis,
              medias69bis,medias115bis)

par(cex.axis=0.8)
boxplot(data=union1,tasa~modelo,col="pink",main='TASA FALLOS')
boxplot(data=union1,auc~modelo,col="pink",main='AUC')


# CONSTRUCCION DE TODOS LOS ENSAMBLADOS

unipredi<-cbind(predi2,predi16,predi19,predi26,predi45,predi57,predi69,predi115)

# Esto es para eliminar columnas duplicadas
unipredi<- unipredi[, !duplicated(colnames(unipredi))]

# Construccion de ensamblados, cambiar al gusto

# logi bagg   avnnet   RF   GBM   XGBM   SVMRBF

unipredi$predi9<-(unipredi$logi+unipredi$avnnet)/2
unipredi$predi10<-(unipredi$logi+unipredi$RF)/2
unipredi$predi11<-(unipredi$logi+unipredi$GBM)/2 
unipredi$predi12<-(unipredi$logi+unipredi$XGBM)/2
unipredi$predi13<-(unipredi$logi+unipredi$SVMRBF)/2  
unipredi$predi16<-(unipredi$avnnet+unipredi$RF)/2
unipredi$predi17<-(unipredi$avnnet+unipredi$GBM)/2
unipredi$predi18<-(unipredi$avnnet+unipredi$XGBM)/2
unipredi$predi19<-(unipredi$avnnet+unipredi$SVMRBF)/2
unipredi$predi22<-(unipredi$RF+unipredi$GBM)/2
unipredi$predi23<-(unipredi$RF+unipredi$XGBM)/2
unipredi$predi24<-(unipredi$RF+unipredi$SVMRBF)/2
unipredi$predi27<-(unipredi$GBM+unipredi$XGBM)/2
unipredi$predi28<-(unipredi$GBM+unipredi$SVMRBF)/2
unipredi$predi31<-(unipredi$logi+unipredi$avnnet+unipredi$RF)/3
unipredi$predi32<-(unipredi$logi+unipredi$avnnet+unipredi$GBM)/3
unipredi$predi33<-(unipredi$logi+unipredi$avnnet+unipredi$XGBM)/3
unipredi$predi34<-(unipredi$logi+unipredi$avnnet+unipredi$SVMRBF)/3
unipredi$predi37<-(unipredi$logi+unipredi$RF+unipredi$GBM)/3
unipredi$predi38<-(unipredi$logi+unipredi$RF+unipredi$XGBM)/3
unipredi$predi39<-(unipredi$logi+unipredi$RF+unipredi$SVMRBF)/3
unipredi$predi42<-(unipredi$logi+unipredi$GBM+unipredi$XGBM)/3
unipredi$predi43<-(unipredi$logi+unipredi$GBM+unipredi$XGBM)/3
unipredi$predi44<-(unipredi$logi+unipredi$GBM+unipredi$SVMRBF)/3
unipredi$predi47<-(unipredi$logi+unipredi$XGBM+unipredi$SVMRBF)/3
unipredi$predi50<-(unipredi$RF+unipredi$GBM+unipredi$SVMRBF)/3
unipredi$predi53<-(unipredi$RF+unipredi$XGBM+unipredi$SVMRBF)/3
unipredi$predi56<-(unipredi$RF+unipredi$avnnet+unipredi$GBM)/3
unipredi$predi57<-(unipredi$RF+unipredi$avnnet+unipredi$XGBM)/3
unipredi$predi58<-(unipredi$RF+unipredi$avnnet+unipredi$SVMRBF)/3
unipredi$predi61<-(unipredi$avnnet+unipredi$GBM+unipredi$SVMRBF)/3
unipredi$predi64<-(unipredi$logi+unipredi$RF+unipredi$GBM+unipredi$avnnet)/4
unipredi$predi65<-(unipredi$logi+unipredi$RF+unipredi$XGBM+unipredi$avnnet)/4
unipredi$predi66<-(unipredi$logi+unipredi$RF+unipredi$XGBM+unipredi$avnnet)/4
unipredi$predi67<-(unipredi$logi+unipredi$RF+unipredi$XGBM+unipredi$avnnet+unipredi$SVMRBF)/5


# Listado de modelos a considerar, cambiar al gusto

dput(names(unipredi))

listado<-c("logi", "avnnet",  "bagg",
           "RF","GBM",  "XGBM", "SVMRBF",
           "predi9", "predi10", "predi11", "predi12", "predi13", 
           "predi16", "predi17", "predi18", "predi19", "predi22", "predi23", 
           "predi24", "predi27", "predi28", "predi31", "predi32", "predi33", 
           "predi34", "predi37", "predi38", "predi39", "predi42", "predi43", 
           "predi44", "predi47", "predi50", "predi53", "predi56", "predi57", 
           "predi58", "predi61", "predi64", "predi65", "predi66", "predi67")

# Cambio a Yes, No, todas las predicciones

# Defino funcion tasafallos

tasafallos<-function(x,y) {
  confu<-confusionMatrix(x,y)
  tasa<-confu[[3]][1]
  return(tasa)
}

auc<-function(x,y) {
  curvaroc<-roc(response=x,predictor=y)
  auc<-curvaroc$auc
  return(auc)
}

# Se obtiene el numero de repeticiones CV y se calculan las medias por repe en
# el data frame medias0

repeticiones<-nlevels(factor(unipredi$Rep))
unipredi$Rep<-as.factor(unipredi$Rep)
unipredi$Rep<-as.numeric(unipredi$Rep)


medias0<-data.frame(c())
for (prediccion in listado)
{
  unipredi$proba<-unipredi[,prediccion]
  unipredi[,prediccion]<-ifelse(unipredi[,prediccion]>0.5,"Yes","No")
  for (repe in 1:repeticiones)
  {
    paso <- unipredi[(unipredi$Rep==repe),]
    pre<-factor(paso[,prediccion])
    archi<-paso[,c("proba","obs")]
    archi<-archi[order(archi$proba),]
    obs<-paso[,c("obs")]
    tasa=1-tasafallos(pre,obs)
    t<-as.data.frame(tasa)
    t$modelo<-prediccion
    auc<-auc(archi$obs,archi$proba)
    t$auc<-auc
    medias0<-rbind(medias0,t)
  }
}

# Finalmente boxplot

par(cex.axis=0.5,las=2)
boxplot(data=medias0,tasa~modelo,col="pink",main="TASA FALLOS")

# Para AUC se utiliza la variable auc del archivo medias0

boxplot(data=medias0,auc~modelo,col="pink",main="AUC")

# PRESENTACION TABLA MEDIAS

tablamedias<-medias0 %>%
  group_by(modelo) %>%
  summarize(tasa=mean(tasa))     

tablamedias<-tablamedias[order(tablamedias$tasa),]


# ORDENACIÃN DEL FACTOR MODELO POR LAS MEDIAS EN TASA
# PARA EL GRAFICO

medias0$modelo <- with(medias0,
                       reorder(modelo,tasa, mean))
par(cex.axis=1.1,las=2)
boxplot(data=medias0,tasa~modelo,col="pink", main='TASA FALLOS')

# ************************************
# PARA AUC
# ************************************

# PRESENTACION TABLA MEDIAS

tablamedias2<-medias0 %>%
  group_by(modelo) %>%
  summarize(auc=mean(auc))     

tablamedias2<-tablamedias2[order(-tablamedias2$auc),]


# ORDENACIÃN DEL FACTOR MODELO POR LAS MEDIAS EN AUC
# PARA EL GRAFICO

medias0$modelo <- with(medias0,
                       reorder(modelo,auc, mean))
par(cex.axis=1.1,las=2)
boxplot(data=medias0,auc~modelo,col="pink", main='AUC')

###################################


########## 
# AutoML #
########## 
if ("package:h2o" %in% search()) { detach("package:h2o", unload=TRUE) }
if ("h2o" %in% rownames(installed.packages())) { remove.packages("h2o") }
pkgs <- c("methods","statmod","stats","graphics","RCurl","jsonlite","tools","utils")
for (pkg in pkgs) {
  if (! (pkg %in% rownames(installed.packages()))) { install.packages(pkg) }
}
install.packages("h2o", type="source", repos=(c("http://h2o-release.s3.amazonaws.com/h2o/rel-turchin/9/R")))


library(h2o)
h2o.init()
start_time <- Sys.time()


# Traducir el archivo a h2o
datoscompletos$b<-as.factor(datoscompletos$b) #Ponemos la vble dependiente como factor
train<- as.h2o(datoscompletos)


# Nota: en lugar de poner max_models=m, 
# se puede limitar el tiempo de proceso con max_runtime_secs = 60 por ejemplo

# Los modelos que prueba con AutoML por defecto son: 

# Redes (h20.deeplearning)
# Gbm (h20.gbm)
# Random forest (h20.drf)
# LogÃ?stica o regresiÃ³n, ambos LASSO (h20.glm)
# Ensamblado (stacking) de varios modelos
summary(datoscompletos)

aml <- h2o.automl(x = c(1:52,54:200),y=53,
                  training_frame = train,max_models = 20, seed = 1,
                  keep_cross_validation_predictions=TRUE,nfolds=4) #nfolds por validacion cruzada repetida


lb <- aml@leaderboard 
#Aml es el objeto creado en el paso anterior
#creamos otro que es lb que incluye leaderboard que son los objetos ganadores
print(lb, n = nrow(lb))  # Print all rows instead of default (6 rows)


aml@leader #para observar el modelo ganador


end_time <- Sys.time()

end_time - start_time

#Vemos mas informacion sobre el modelo ganador
aml@leader

#ID GANADOR "StackedEnsemble_BestOfFamily_AutoML_20200418_123809"

modelo2 <- h2o.getModel("StackedEnsemble_BestOfFamily_AutoML_20200418_123809")


h2o.shutdown()


############################################
# Hacemos seleccion de variables:

var2<-c("fnlwgt","capital_loss","capital_gain","age","education_num","hours_per_week","education.Bachelors","education.MasteryDoctorado","education.Preschool","education.School","marital.Divorced","marital.Married","marital.Nevermarried","race.Black","race.White","relationship.Husband","relationship.Notinfamily","relationship.Ownchild","relationship.Unmarried","gender.Female","native_country.Si","occupation.Craftrepair","occupation.Execmanagerial","occupation.Machineopinspct","occupation.Otherservice","occupation.Profspecialty","occupation.Sales","workclass.Otro","workclass.Private","workclass.Selfempl") 

length(var2)

# Para clasificaciÃ³n hay que definir como factor la dependiente

datoscompletos$b<-as.factor(datoscompletos$b)

library(MASS)
data<-datoscompletos

full<-glm(b~.,data=data,family = binomial(link="logit"))
null<-glm(b~1,data=data,family = binomial(link="logit"))

selec1<-stepAIC(null,scope=list(upper=full),direction="both",trace=FALSE,family = binomial(link="logit"))

summary(selec1)

formula(selec1)

varsel<-c("salary_50k","marital.Married","education_num","hours_per_week",
          "age","occupation.Execmanagerial","relationship.Ownchild", 
          "capital_loss","native_country.No","occupation.Otherservice", 
          "workclass.Otro","workclass.Private","occupation.Machineopinspct", 
          "race.Black","fnlwgt")

datoscompletos2<-datoscompletos[,varsel] 

length(varsel)

library(h2o)

h2o.init()


# aml = H2OAutoML(max_runtime_secs = 120)    
train<- as.h2o(datoscompletos2)
summary(datoscompletos2)

aml <- h2o.automl(x = 2:15,y=1,training_frame = train,max_models = 20,seed = 1)

lb <- aml@leaderboard
print(lb, n = nrow(lb))  # Print all rows instead of default (6 rows)



#                                              model_id       auc   logloss mean_per_class_error      rmse
# 1            GLM_grid_1_AutoML_20190428_120526_model_1 0.8040881 0.4815283            0.2611905 0.3980979
# 2  StackedEnsemble_BestOfFamily_AutoML_20190428_120526 0.8039214 0.4834851            0.2609524 0.3970062
# 3     StackedEnsemble_AllModels_AutoML_20190428_120526 0.8020524 0.4843023            0.2557143 0.3970071
# 4   DeepLearning_grid_1_AutoML_20190428_120526_model_2 0.7973833 0.5249502            0.2647619 0.4070323
# 5                         GBM_3_AutoML_20190428_120526 0.7884762 0.4996318            0.2735714 0.4054799
# 6            GBM_grid_1_AutoML_20190428_120526_model_5 0.7878571 0.5010849            0.2754762 0.4062418
# 7            GBM_grid_1_AutoML_20190428_120526_model_1 0.7846381 0.5589271            0.2735714 0.4334643
# 8                         GBM_2_AutoML_20190428_120526 0.7823810 0.5047958            0.2819048 0.4077451
# 9   DeepLearning_grid_1_AutoML_20190428_120526_model_5 0.7817119 0.5415844            0.2864286 0.4111001
# 10                        GBM_4_AutoML_20190428_120526 0.7807738 0.5096925            0.2883333 0.4101473


#Vemos el modelo ganador
aml@leader

#ID GANADOR "StackedEnsemble_BestOfFamily_AutoML_20200418_191803"

modelo2 <- h2o.getModel("StackedEnsemble_BestOfFamily_AutoML_20200418_191803")
modelo2






#Variables del primer grupo 
# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														
grupo1 <- c("aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0")
paste(grupo1,collapse="+")
# aa+ab+ac+ad+ae+af+ag+ah+ai+aj+ak+al+am+an+ap+ax+ay+az+ba+bb+bc+bd+d+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

#Variables del segundo grupo 
# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"
grupo2 <- c("ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1")
paste(grupo2,collapse="+")
# ag+aj+al+am+bv+c+d+k+n+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+ca.1+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1

#Variables del tercer grupo 
# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			
grupo3 <- c("al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1")
paste(grupo3,collapse="+")
# al+an+ax+bv+c+d+k+r+t+u+v+w+y+g.N+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+bm.1+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bn.1+bn.2+bn.3+bp.1+bp.2+bp.3+br.1+br.2+br.3+bt.1+bt.2+bt.3+bw.1+bw.2+by.1+by.2+bz.1+bz.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+ck.1+ck.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+cq.1+cr.1+cr.2+ct.1

#Variables del cuarto grupo 
# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															
grupo4 <- c("ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0")
paste(grupo4,collapse="+")
# ab+ac+ad+ae+af+ag+ai+aj+ak+an+ax+ay+ba+bb+bd+c+d+h+i+s+t+u+w+x+z+e.1+f.N+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3+av.0+aw.0+ao.0

#Variables del quinto grupo 
# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				
grupo5 <- c("ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1")
paste(grupo5,collapse="+")
# ac+ai+an+d+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1

#Variables del sexto grupo 
# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		
grupo6 <- c("ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1")
paste(grupo6,collapse="+")
# ac+ag+ai+an+d+s+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1

#Variables del septimo grupo 
# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			
grupo7 <- c("ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1") 
paste(grupo7,collapse="+")
# ac+ai+an+d+s+t+u+w+x+g.N+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+aw.0+bf.1+bf.2+bf.3+bj.1+bj.2+bk.1+bk.2+bk.3+bl.1+bl.2+bp.1+bp.2+bp.3+bq.1+bq.2+bq.3+bt.1+bt.2+bt.3+by.1+by.2+cb.1+cb.2+cc.1+cc.2+cc.3+cf.1+cg.1+cj.1+cj.2+cl.1+cl.2+cl.3+cn.1+cn.2+cn.3+co.1+co.2+ct.1

#Variables del octavo grupo
# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														
grupo8 <- c("aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3")
paste(grupo8,collapse="+")
# aa+ab+ac+af+ak+bc+bd+h+j+k+l+r+s+w+x+y+ar.0+ar.1+ar.2+ar.3+ar.4+ar.5+ar.6+as.0+as.1+as.2+as.3+at.0+at.1+at.2+au.0+au.1+au.2+au.3


# GRUPO 1 =	"aa",	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ah",	"ai",	"aj",	"ak",	"al",	"am",	"an",	"ap",	"ax",	"ay",	"az",	"ba",	"bb",	"bc",	"bd",	"d",	"h",	"i",	"j",	"k",	"l",	"m",	"n",	"o",	"p",	"q",	"r",	"s",	"t",	"u",	"v",	"w",	"x",	"y",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"														

# GRUPO 2 =	"ag",	"aj",	"al",	"am",	"bv",	"c",	"d",	"k",	"n",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"ca.1",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"

# GRUPO 3 =	"al",	"an",	"ax",	"bv",	"c",	"d",	"k",	"r",	"t",	"u",	"v",	"w",	"y",	"g.N",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"bm.1",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bn.1",	"bn.2",	"bn.3",	"bp.1",	"bp.2",	"bp.3",	"br.1",	"br.2",	"br.3",	"bt.1",	"bt.2",	"bt.3",	"bw.1",	"bw.2",	"by.1",	"by.2",	"bz.1",	"bz.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"ck.1",	"ck.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"cq.1",	"cr.1",	"cr.2",	"ct.1"			

# GRUPO 4 =	"ab",	"ac",	"ad",	"ae",	"af",	"ag",	"ai",	"aj",	"ak",	"an",	"ax",	"ay",	"ba",	"bb",	"bd",	"c",	"d",	"h",	"i",	"s",	"t",	"u",	"w",	"x",	"z",	"e.1",	"f.N",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3",	"av.0",	"aw.0",	"ao.0"																															

# GRUPO 5 =	"ac",	"ai",	"an",	"d",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																				

# GRUPO 6 =	"ac",	"ag",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																		

# GRUPO 7 =	"ac",	"ai",	"an",	"d",	"s",	"t",	"u",	"w",	"x",	"g.N",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"aw.0",	"bf.1",	"bf.2",	"bf.3",	"bj.1",	"bj.2",	"bk.1",	"bk.2",	"bk.3",	"bl.1",	"bl.2",	"bp.1",	"bp.2",	"bp.3",	"bq.1",	"bq.2",	"bq.3",	"bt.1",	"bt.2",	"bt.3",	"by.1",	"by.2",	"cb.1",	"cb.2",	"cc.1",	"cc.2",	"cc.3",	"cf.1",	"cg.1",	"cj.1",	"cj.2",	"cl.1",	"cl.2",	"cl.3",	"cn.1",	"cn.2",	"cn.3",	"co.1",	"co.2",	"ct.1"																			

# GRUPO 8 =	"aa",	"ab",	"ac",	"af",	"ak",	"bc",	"bd",	"h",	"j",	"k",	"l",	"r",	"s",	"w",	"x",	"y",	"ar.0",	"ar.1",	"ar.2",	"ar.3",	"ar.4",	"ar.5",	"ar.6",	"as.0",	"as.1",	"as.2",	"as.3",	"at.0",	"at.1",	"at.2",	"au.0",	"au.1",	"au.2",	"au.3"																																														

